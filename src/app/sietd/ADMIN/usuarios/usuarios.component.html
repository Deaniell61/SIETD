<ol class="breadcrumb">
  <li class="breadcrumb-item">
      <a href="#">SIETD</a>
  </li>
  <li class="breadcrumb-item">
      <a href="#">ADMIN</a>
  </li>
  <li class="breadcrumb-item">
    <a href="#">Usuarios</a>
</li>
  <li class="breadcrumb-item active"> Ingreso de Datos</li>
</ol>
<div class="card mb-3">
  <div class="card-header">
      <i class="fa fa-table"></i> Lista de Registros
  </div>
  <div class="card-body">

      <div class="table-responsive">
          <div class="box-body">
            <div class="row">
              <div class="col-md-2">
                <button type="button" class="btn btn-lg btn-primary" data-toggle="modal" data-target="#insertModal" style="cursor:pointer;"><i class="fa fa-plus"></i>Agregar Nuevo</button>
              </div>
              
            </div>  
            <div class="table-responsive">
              <table class="table table-hover table-responsive" [mfData]="userTable" #mf="mfDataTable"
                             [mfRowsOnPage]="rowsOnPage">
                <thead>
                  <tr>
                      <th style="width:20%;">
                                    <mfDefaultSorter by="nombres">Nombre</mfDefaultSorter></th>
                      <th style="width:20%;">
                                    <mfDefaultSorter by="username">Usuario</mfDefaultSorter></th>
                      <th style="width:20%;">
                                    <mfDefaultSorter by="correo_electronico">Email</mfDefaultSorter></th>
                      <th style="width:20%;">
                                    <mfDefaultSorter by="usuario_rol">Rol</mfDefaultSorter></th>
                      <th style="width:20%;">
                                    <mfDefaultSorter by="firstname"></mfDefaultSorter></th>
                  </tr>
              </thead>
              <tbody>
                  <tr *ngFor="let user of mf.data">
                      <td>{{((user.nombres!=null)?user.nombres+' ':'')+((user.apellidos!=null)?user.apellidos:'')}}</td>
                      <td>{{((user.username!=null)?user.username:'')}}</td>
                      <td>{{((user.correo_electronico!=null)?user.correo_electronico:'')}}</td>
                      <td>{{(user.usuario_rol.nombre!=null)?user.usuario_rol.nombre:''}}</td>
                      <td>

                        <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#editModal" (click)="cargarUser(user.id)" style="cursor:pointer;"><i class="fa fa-edit"></i> Editar</button>
                        <button type="button" class="btn btn-danger" (click)="deleteUser(user.id)" style="cursor:pointer;"><i class="fa fa-times"></i> Eliminar</button>
                        
                      </td>
                  </tr>
                  
              </tbody>
              <tfoot>
                  <tr>
                      <td colspan="5">
                          <mfBootstrapPaginator [rowsOnPageSet]="[5,10,15]"></mfBootstrapPaginator>
                      </td>
                  </tr>
                  </tfoot>
                  </table>
              </div>
          </div>
      </div>
  </div>
  <div class="card-footer small text-muted">
      Updated yesterday at 11:59 PM
  </div>
</div>

<simple-notifications [options]="options"></simple-notifications>


<div id="insertModal"  class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Ingreso de datos</h4>
            </div>
            <div class="modal-body">
                <form id="insert-form" class="row" #InsertUserForm="ngForm" (ngSubmit)="insertUser(InsertUserForm.value)">
                    <div class="form-group col-xl-12 mb-12">
                        <label for="dpi">DPI</label>
                        <input type="text" class="form-control" id="dpi" name="dpi" required
                                ngModel #dpi="ngModel" placeholder="DPI">
                          <div *ngIf="dpi.invalid && (dpi.dirty || dpi.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="dpi.errors.required">
                                  El DPI es invalido
                              </small>
                          </div>
                    </div> 
                    <div class="form-group col-xl-6 mb-6">
                        <label for="nombres">Nombres</label>
                        <input type="text" class="form-control" id="nombres" name="nombres" required
                                ngModel #nombres="ngModel" placeholder="Nombres">
                          <div *ngIf="nombres.invalid && (nombres.dirty || nombres.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="nombres.errors.required">
                                  Los Nombres son invalido
                              </small>
                          </div>
                    </div> 
                    <div class="form-group col-xl-6 mb-6">
                        <label for="apellidos">Apellidos</label>
                        <input type="text" class="form-control" id="apellidos" name="apellidos" required
                                ngModel #apellidos="ngModel" placeholder="Apellidos">
                          <div *ngIf="apellidos.invalid && (apellidos.dirty || apellidos.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="apellidos.errors.required">
                                  Los Apellidos son invalido
                              </small>
                          </div>
                    </div> 
                    <div class="form-group col-xl-6 mb-6">
                        <label for="telefono">Telefono</label>
                        <input type="text" class="form-control" id="telefono" name="telefono" required
                                ngModel #telefono="ngModel" placeholder="Telefono">
                          <div *ngIf="telefono.invalid && (telefono.dirty || telefono.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="telefono.errors.required">
                                  El Telefono es invalido
                              </small>
                          </div>
                    </div> 
                    <div class="form-group col-xl-6 mb-6">
                        <label for="direccion">Direccion</label>
                        <input type="text" class="form-control" id="direccion" name="direccion" required
                                ngModel #direccion="ngModel" placeholder="Direccion">
                          <div *ngIf="direccion.invalid && (direccion.dirty || direccion.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="direccion.errors.required">
                                  La Direccion es invalido
                              </small>
                          </div>
                    </div> 
                    <div class="form-group col-xl-6 mb-6">
                        <label for="fecha_nacimiento">Fecha de Nacimiento</label>
                        <input type="date" class="form-control" id="fecha_nacimiento" name="fecha_nacimiento" required
                                ngModel #fecha_nacimiento="ngModel" [(ngModel)]="beginDate" (change)="cargarEdad(fecha_nacimiento.value)">
                          <div *ngIf="fecha_nacimiento.invalid && (fecha_nacimiento.dirty || fecha_nacimiento.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="fecha_nacimiento.errors.required">
                                 La Fecha de Nacimiento es invalido
                              </small>
                          </div>
                    </div> 
                    <div class="form-group col-xl-6 mb-6">
                      <label for="edad">Edad</label>
                      <input type="text" class="form-control" id="edad" name="edad" required
                              ngModel #edad="ngModel" placeholder="Edad" [(ngModel)]="age">
                        <div *ngIf="edad.invalid && (edad.dirty || edad.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="edad.errors.required">
                                La Edad es invalido
                            </small>
                        </div>
                  </div>
                    
                  <div class="form-group col-xl-6 mb-6">
                    <label for="departamento">departamento</label>
                    <input type="text" class="form-control" id="departamento" name="departamento" required ngModel #departamento="ngModel" placeholder="departamento">
                    <div *ngIf="departamento.invalid && (departamento.dirty || departamento.touched)" class="alert alert-danger" role="alert">
                        <small *ngIf="departamento.errors.required">
                            El departamento es invalido
                        </small>
                    </div>
                </div>
                    
                    <div *ngIf="muniCombo" class="form-group col-xl-6 mb-6">
                        <label for="municipio">Municipios</label>
                        <select name="municipio" class="form-control" id="municipio" required ngModel #municipio="ngModel">
                          <option value="4"></option>
                          <option *ngFor="let Data of muniCombo" value="{{Data.id}}">{{Data.nombre}}</option>
                        </select>
                          <div *ngIf="municipio.invalid && (municipio.dirty || municipio.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="municipio.errors.required">
                                  El Usuario es invalido
                              </small>
                          </div>
                    </div>

                    
                    <div class="form-group col-xl-6 mb-6">
                        <label for="username">Username</label>
                        <input type="text" class="form-control" id="username" name="username" required
                                ngModel #username="ngModel" placeholder="Username">
                          <div *ngIf="username.invalid && (username.dirty || username.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="username.errors.required">
                                  El Usuario es invalido
                              </small>
                          </div>
                    </div> 
                    
                    <div class="form-group col-xl-6 mb-6">
                          <label for="correo_electronico">correo_electronico</label>
                          <input type="correo_electronico" class="form-control" id="correo_electronico" name="correo_electronico" required
                                  ngModel #correo_electronico="ngModel" placeholder="correo_electronico">
                            <div *ngIf="correo_electronico.invalid && (correo_electronico.dirty || correo_electronico.touched)"
                                  class="alert alert-danger" role="alert">
                                <small *ngIf="correo_electronico.errors.required">
                                    El correo_electronico es invalido
                                </small>
                            </div>
                    </div>
                    
                    <div class="form-group col-xl-12 mb-15">
                        <label for="rol">Tipo</label>
                        <select name="rol" class="form-control" id="rol" required ngModel #rol="ngModel">
                          <option value="4"></option>
                          <option *ngFor="let userType of userTypesCombo" value="{{userType.id}}">{{userType.nombre}}</option>
                        </select>
                    </div>
                  <div class="form-group col-xl-6 mb-6">
                    <label for="entidad">Entidad</label>
                    <select name="entidad" class="form-control" id="entidad" required ngModel #entidad="ngModel">
                          <option value="4"></option>
                          <option *ngFor="let Data of entiCombo" value="{{Data.id}}">{{Data.nombre}}</option>
                        </select>
                    <div *ngIf="entidad.invalid && (entidad.dirty || entidad.touched)" class="alert alert-danger" role="alert">
                        <small *ngIf="entidad.errors.required">
                            El entidad es invalido
                        </small>
                    </div>
                </div>
                      
                    <div class="form-group col-xl-12 text-right mb-15">
                        <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-close" ></i> Cancel</button>
                        <button type="submit" class="btn btn-success"><i class="fa fa-save"></i> Guardar</button>
                    </div>
                </form>
                
            </div>
            <div class="modal-footer" style="border:none;">
            </div>
        </div>
    </div>
    
    
    
  </div>

<div id="editModal"  class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog modal-lg">
      <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h4 class="modal-title">Edicion de datos</h4>
          </div>
           <div class="modal-body" *ngIf="selectedUser">
              <form id="update-form" class="row" #UpdateUserForm="ngForm" (ngSubmit)="updateUser(UpdateUserForm.value)">
                  <div class="form-group col-xl-12 mb-12">
                      <label for="dpi">DPI</label>
                      <input type="text" class="form-control" id="dpi" name="dpi" required
                              ngModel #dpi="ngModel" placeholder="DPI" [(ngModel)]="selectedUser.dpi">
                        <div *ngIf="dpi.invalid && (dpi.dirty || dpi.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="dpi.errors.required">
                                El DPI es invalido
                            </small>
                        </div>
                  </div> 
                  <div class="form-group col-xl-6 mb-6">
                      <label for="nombres">Nombres</label>
                      <input type="text" class="form-control" id="nombres" name="nombres" required
                              ngModel #nombres="ngModel" placeholder="Nombres" [(ngModel)]="selectedUser.nombres">
                        <div *ngIf="nombres.invalid && (nombres.dirty || nombres.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="nombres.errors.required">
                                Los Nombres son invalido
                            </small>
                        </div>
                  </div> 
                  <div class="form-group col-xl-6 mb-6">
                      <label for="apellidos">Apellidos</label>
                      <input type="text" class="form-control" id="apellidos" name="apellidos" required
                              ngModel #apellidos="ngModel" placeholder="Apellidos" [(ngModel)]="selectedUser.apellidos">
                        <div *ngIf="apellidos.invalid && (apellidos.dirty || apellidos.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="apellidos.errors.required">
                                Los Apellidos son invalido
                            </small>
                        </div>
                  </div> 
                  <div class="form-group col-xl-6 mb-6">
                      <label for="telefono">Telefono</label>
                      <input type="text" class="form-control" id="telefono" name="telefono" required
                              ngModel #telefono="ngModel" placeholder="Telefono" [(ngModel)]="selectedUser.telefono">
                        <div *ngIf="telefono.invalid && (telefono.dirty || telefono.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="telefono.errors.required">
                                El Telefono es invalido
                            </small>
                        </div>
                  </div> 
                  <div class="form-group col-xl-6 mb-6">
                      <label for="direccion">Direccion</label>
                      <input type="text" class="form-control" id="direccion" name="direccion" required
                              ngModel #direccion="ngModel" placeholder="Direccion" [(ngModel)]="selectedUser.direccion">
                        <div *ngIf="direccion.invalid && (direccion.dirty || direccion.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="direccion.errors.required">
                                La Direccion es invalido
                            </small>
                        </div>
                  </div> 
                  <div class="form-group col-xl-6 mb-6">
                      <label for="fecha_nacimiento">Fecha de Nacimiento</label>
                      <input type="date" class="form-control" id="fecha_nacimiento" name="fecha_nacimiento" required
                              ngModel #fecha_nacimiento="ngModel" [(ngModel)]="selectedUser.fecha_nacimiento" (change)="cargarEdad(fecha_nacimiento.value)">
                        <div *ngIf="fecha_nacimiento.invalid && (fecha_nacimiento.dirty || fecha_nacimiento.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="fecha_nacimiento.errors.required">
                               La Fecha de Nacimiento es invalido
                            </small>
                        </div>
                  </div> 
                  <div class="form-group col-xl-6 mb-6">
                    <label for="edad">Edad</label>
                    <input type="text" class="form-control" id="edad" name="edad" required
                            ngModel #edad="ngModel" placeholder="Edad" [(ngModel)]="selectedUser.edad">
                      <div *ngIf="edad.invalid && (edad.dirty || edad.touched)"
                            class="alert alert-danger" role="alert">
                          <small *ngIf="edad.errors.required">
                              La Edad es invalido
                          </small>
                      </div>
                </div>
                  <div class="form-group col-xl-6 mb-6">
                      <label for="departamento">Departamentos</label>
                      <select name="departamento" class="form-control" id="departamento" required ngModel #departamento="ngModel" (change)="cargarMunicipios(departamento.value)"
                      [(ngModel)]="selectedUser.departamento">
                        <option value="4"></option>
                        <option *ngFor="let Data of deptosCombo" value="{{Data.id}}">{{Data.nombre}}</option>
                      </select>
                        <div *ngIf="departamento.invalid && (departamento.dirty || departamento.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="departamento.errors.required">
                                El Usuario es invalido
                            </small>
                        </div>
                  </div>
                  
                  <div class="form-group col-xl-6 mb-6">
                      <label for="municipio">Municipios</label>
                      <select name="municipio" class="form-control" id="municipio" required ngModel #municipio="ngModel" [(ngModel)]="selectedUser.municipio">
                        <option value="4"></option>
                        <option *ngFor="let Data of muniCombo" value="{{Data.id}}">{{Data.nombre}}</option>
                      </select>
                        <div *ngIf="municipio.invalid && (municipio.dirty || municipio.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="municipio.errors.required">
                                El Usuario es invalido
                            </small>
                        </div>
                  </div>

                  
                  <div class="form-group col-xl-6 mb-6">
                      <label for="username">Username</label>
                      <input type="text" class="form-control" id="username" name="username" required
                              ngModel #username="ngModel" placeholder="Username" [(ngModel)]="selectedUser.username">
                        <div *ngIf="username.invalid && (username.dirty || username.touched)"
                              class="alert alert-danger" role="alert">
                            <small *ngIf="username.errors.required">
                                El Usuario es invalido
                            </small>
                        </div>
                  </div> 
                  
                  <div class="form-group col-xl-6 mb-6">
                        <label for="correo_electronico">Correo Electronico</label>
                        <input type="correo_electronico" class="form-control" id="correo_electronico" name="correo_electronico" required
                                ngModel #correo_electronico="ngModel" placeholder="correo_electronico" [(ngModel)]="selectedUser.correo_electronico">
                          <div *ngIf="correo_electronico.invalid && (correo_electronico.dirty || correo_electronico.touched)"
                                class="alert alert-danger" role="alert">
                              <small *ngIf="correo_electronico.errors.required">
                                  El correo_electronico es invalido
                              </small>
                          </div>
                  </div>
                  
                  <div class="form-group col-xl-12 mb-15">
                      <label for="rol">Tipo</label>
                      <select name="rol" class="form-control" id="rol" required ngModel #rol="ngModel" [(ngModel)]="selectedUser.rol">
                        <option value="4"></option>
                        <option *ngFor="let userType of userTypesCombo" value="{{userType.id}}">{{userType.nombre}}</option>
                      </select>
                  </div>
                  <div class="form-group col-xl-6 mb-6">
                    <label for="entidad">Entidad</label>
                    <select name="entidad" class="form-control" id="entidad" required ngModel #entidad="ngModel" [(ngModel)]="selectedUser.entidad">
                          <option value="4"></option>
                          <option *ngFor="let Data of entiCombo" value="{{Data.id}}">{{Data.nombre}}</option>
                        </select>
                    <div *ngIf="entidad.invalid && (entidad.dirty || entidad.touched)" class="alert alert-danger" role="alert">
                        <small *ngIf="entidad.errors.required">
                            El entidad es invalido
                        </small>
                    </div>
                </div>
                  <input type="hidden" class="form-control" id="id" name="id" required
                            ngModel #id="ngModel" [(ngModel)]="selectedUser.id">

                  <div class="form-group col-xl-12 text-right mb-15">
                      <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-close" ></i> Cancel</button>
                      <button type="submit" class="btn btn-success"><i class="fa fa-save"></i> Guardar</button>
                  </div>
              </form>
              
          </div>
          <div class="modal-footer" style="border:none;">
            
          </div>
      </div>
  </div>
  
  
  
</div>



<div class="modal fade" id="SubirModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog modal-lg" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Upload Data</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
        <div class="container">
            <div class="panel panel-default">
                <div class="panel-body">
        
                    <!-- Standar Form -->
                    <h4>Seleccionar archivos de su equipo</h4>
                    <br />
                    <form action="" method="post" enctype="multipart/form-data" id="js-upload-form">
                        <div class="form-inline">
                            <div class="form-group">
                                <input type="file" name="files[]" id="js-upload-files" multiple>
                            </div>
                            <button type="submit" class="btn btn-sm btn-primary" id="js-upload-submit">Enviar</button>
                        </div>
                    </form>
                    <br />
                    <!-- Drop Zone -->
                    <h4>O arrastre y suelte los archivos a continuación</h4>
                    <div class="upload-drop-zone" id="drop-zone" (click)="create()">
                        Just drag and drop files here
                    </div>
        
                    <!-- Progress Bar -->
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
                            <span class="sr-only">60% Completado</span>
                        </div>
                    </div>
                    <br />
                    <!-- Upload Finished -->
                    <div class="js-upload-finished">
                        <h3>Archivos procesados</h3>
                        <div class="list-group">
                            <a href="#" class="list-group-item list-group-item-success"><span class="badge alert-success pull-right">Success</span>archivo-01.xml</a>
                            <a href="#" class="list-group-item list-group-item-success"><span class="badge alert-success pull-right">Success</span>archivo-02.xml</a>
                            <a href="#" class="list-group-item list-group-item-success"><span class="badge alert-success pull-right">Success</span>archivo-03.xml</a>
                            <a href="#" class="list-group-item list-group-item-danger"><span class="badge alert-danger pull-right">Error</span>archivo-03.xml</a>
                            <a href="#" class="list-group-item list-group-item-success"><span class="badge alert-success pull-right">Success</span>archivo-04.xml</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
     
    </div>
  </div>
</div>
<simple-notifications [options]="options"></simple-notifications>

</div>


<div class="modal fade" id="Loading"  tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="text-center" style="margin-top:50%;">
<app-loader></app-loader>
    </div>
  </div>
</div>
